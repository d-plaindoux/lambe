impl error
impl list
impl option

data Stack a {
    value : List a
}

data StackUnderFlow

impl for Stack a {
    sig new : self
    def new = Stack $ List empty

    sig push : self -> a -> self
    def push a = self with value = a :: self.value

    sig peek : self -> Option a
    def peek = self value

    sig pop  : self -> self with Error StackUnderFlow
    def pop = self with value = self value fold { StackUnderFlow raise } { $1 tail }
}
