data RangeFromTo { min:int; max:int }
data RangeFromDownTo { min:int; max:int }

type Range = RangeFromTo | RangeFromDownTo

impl Range {
    sig to : self -> self -> Range for int
    def to m2 =
        if (self <= m2)
        then { RangeFromTo self m2 }
        else { RangeFromDownTo self m2 }
}