impl lang.bool
impl stream

type Response a s =
  Rejected { stream   : Stream s
             consumed : bool
           }
| Accepted { value    : a
             stream   : Stream s
             consumed : bool
           }

impl forall a s. Response a s {
    sig fold : forall b. self -> (Rejected s -> b) -> (Accepted a s -> b) -> b

    def fold r a =
        when self {
            is Rejected -> r self
            is Accepted -> a self
        }
}

