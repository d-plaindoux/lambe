impl lang.bool
impl stream

type Response a s =
  Rejected { consumed : bool }
| Accepted { value    : a
             input    : Stream s
             consumed : bool
           }

impl for Response a {
    sig fold : self -> (Rejected-> b) -> (Accepted a -> b) -> b

    def fold r a =
        when self {
            is Rejected -> r self
            is Accepted -> a self
        }
}

