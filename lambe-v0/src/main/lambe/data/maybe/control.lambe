module data.maybe.control

from data.maybe import *
from control.control import *

define Functor MayBe {
  def map (Some v) f = Some (f v)
  def map None     _ = None
}

define Applicative MayBe {
  def (<*>) (Some f) v = v map f
  def (<*>) None     _ = None
}

define (a) Monad (MayBe a) {
  def (>>=) (Some v) f = f v
  def (>>=) None     _ = None
}