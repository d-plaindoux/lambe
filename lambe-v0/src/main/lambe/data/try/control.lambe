module data.try.control

from data.try import *

from control.functor import *
from control.applicative import *
from control.monad import *

define Functor Try {
  def pure = Some
  def fmap (Success v) f = Success (f v)
  def fmap (Failure s) f = Failure s
}

define Applicative Try {
  def (<*>) (Success f) v = v fmap f
  def (<*>) (Failure s) _ = Failure s
}

define Monad Try {
  def (>>=) (Success v) f = f v
  def (>>=) (Failure s) _ = Failure s
}
