module data.try.control

from data.try import *
from control.control import *

define Functor Try {
  def pure = Some
  def fmap f (Success v) = Success (f v)
  def fmap _ (Failure s) = Failure s
}

define Applicative Try {
  def (<*>) (Success f) v = v fmap f
  def (<*>) (Failure s) _ = Failure s
}

define Monad Try {
  def (>>=) f (Success v) = f v
  def (>>=) _ (Failure s) = Failure s
}
